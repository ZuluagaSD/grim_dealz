{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://grimdealz.com/schemas/price_result.schema.json",
  "title": "PriceResult",
  "description": "A single scraped product price from a store. Python scrapers produce this shape; db.py validates before DB write.",
  "type": "object",
  "required": ["gw_item_number", "current_price", "stock_status"],
  "additionalProperties": false,
  "properties": {
    "gw_item_number": {
      "type": "string",
      "description": "GW item number â€” deduplication key (e.g. '48-75', '43-06', '99120101366'). Must match products.gw_item_number exactly.",
      "pattern": "^[0-9]{2,3}-[0-9]{2,3}(-[0-9]{2})?$|^[0-9]{10,13}$",
      "examples": ["48-75", "43-06", "99120101366"]
    },
    "current_price": {
      "type": "number",
      "description": "Current price in USD. Must be positive.",
      "minimum": 0.01,
      "maximum": 9999.99,
      "examples": [42.50, 127.49]
    },
    "stock_status": {
      "type": "string",
      "description": "Normalized stock status. Must match StockStatus enum in Prisma schema and base_store.py.",
      "enum": ["in_stock", "out_of_stock", "backorder", "pre_order", "limited"]
    },
    "store_product_url": {
      "type": ["string", "null"],
      "description": "Direct URL to this product on the store's website.",
      "format": "uri",
      "examples": ["https://www.miniaturemarket.com/gaw48-75.html"]
    },
    "store_sku": {
      "type": ["string", "null"],
      "description": "Store's internal SKU for this product. Used for debugging; not required for DB upsert.",
      "examples": ["GAW48-75", "MM-GW-48-75"]
    },
    "affiliate_url": {
      "type": ["string", "null"],
      "description": "Pre-built affiliate deep link, if the store's affiliate network supports product-level deep links. If null, the /go/ route constructs the URL from store.base_url + listing.store_product_url.",
      "format": "uri"
    }
  }
}
